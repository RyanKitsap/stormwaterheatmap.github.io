<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Land Cover Development | Stormwater Heatmap Technical Reference</title>
  <meta name="description" content="Chapter 3 Land Cover Development | Stormwater Heatmap Technical Reference" />
  <meta name="generator" content="bookdown 0.18.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Land Cover Development | Stormwater Heatmap Technical Reference" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://stormwaterheatmap.github.io/" />
  
  
  <meta name="github-repo" content="stormwaterheatmap" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Land Cover Development | Stormwater Heatmap Technical Reference" />
  
  
  

<meta name="author" content="Christian Nilsen, Geosyntec Consultants, Inc." />
<meta name="author" content="Emily Howe, The Nature Conservancy" />
<meta name="author" content="Jaime Robertson, The Nature Conservancy" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="high-resolution-land-cover.html"/>
<link rel="next" href="hydrology.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-stormwater"><i class="fa fa-check"></i><b>1.1</b> What is stormwater?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#urban-stormwater-runoff-is-a-two-fold-problem-impacting-the-quantity-of-water-pulsing-off-the-land-as-well-as-the-quality-of-that-water."><i class="fa fa-check"></i><b>1.2</b> Urban stormwater runoff is a two-fold problem, impacting the quantity of water pulsing off the land, as well as the quality of that water.</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#water-quantity"><i class="fa fa-check"></i><b>1.2.1</b> Water Quantity</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#water-quality"><i class="fa fa-check"></i><b>1.2.2</b> Water Quality</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#toxic-stormwater-impacts"><i class="fa fa-check"></i><b>1.3</b> Toxic Stormwater Impacts</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#moving-forward--identifying-where-stormwater-pollution-is-generated-on-the-landscape"><i class="fa fa-check"></i><b>1.4</b> Moving forward- identifying where stormwater pollution is generated on the landscape</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#building-an-interactive-tool-to-service-stormwater-manager-needs"><i class="fa fa-check"></i><b>1.5</b> Building an interactive tool to service stormwater manager needs:</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#open-data-helps-us-bound-forward"><i class="fa fa-check"></i><b>1.6</b> Open data helps us bound forward</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="high-resolution-land-cover.html"><a href="high-resolution-land-cover.html"><i class="fa fa-check"></i><b>2</b> High-resolution Land Cover</a><ul>
<li class="chapter" data-level="2.1" data-path="high-resolution-land-cover.html"><a href="high-resolution-land-cover.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="land-cover-development.html"><a href="land-cover-development.html"><i class="fa fa-check"></i><b>3</b> Land Cover Development</a><ul>
<li class="chapter" data-level="3.1" data-path="land-cover-development.html"><a href="land-cover-development.html#validation-and-accuracy-assessment"><i class="fa fa-check"></i><b>3.1</b> Validation and Accuracy Assessment</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hydrology.html"><a href="hydrology.html"><i class="fa fa-check"></i><b>4</b> Hydrology</a><ul>
<li class="chapter" data-level="4.1" data-path="hydrology.html"><a href="hydrology.html#overview-1"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="hydrology.html"><a href="hydrology.html#modeling-approach"><i class="fa fa-check"></i><b>4.2</b> Modeling approach</a><ul>
<li class="chapter" data-level="4.2.1" data-path="hydrology.html"><a href="hydrology.html#hydrologic-response-units"><i class="fa fa-check"></i><b>4.2.1</b> Hydrologic Response Units</a></li>
<li class="chapter" data-level="4.2.2" data-path="hydrology.html"><a href="hydrology.html#regional-calibrated-parameters"><i class="fa fa-check"></i><b>4.2.2</b> Regional Calibrated Parameters</a></li>
<li class="chapter" data-level="4.2.3" data-path="hydrology.html"><a href="hydrology.html#python-implementation"><i class="fa fa-check"></i><b>4.2.3</b> Python Implementation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="hydrology.html"><a href="hydrology.html#data-sources"><i class="fa fa-check"></i><b>4.3</b> Data Sources</a><ul>
<li class="chapter" data-level="4.3.1" data-path="hydrology.html"><a href="hydrology.html#precipitation"><i class="fa fa-check"></i><b>4.3.1</b> Precipitation</a></li>
<li class="chapter" data-level="4.3.2" data-path="hydrology.html"><a href="hydrology.html#potential-evaporation"><i class="fa fa-check"></i><b>4.3.2</b> Potential Evaporation</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="hydrology.html"><a href="hydrology.html#verficiation-of-results"><i class="fa fa-check"></i><b>4.4</b> Verficiation of Results</a></li>
<li class="chapter" data-level="4.5" data-path="hydrology.html"><a href="hydrology.html#spatially-aggregated-results"><i class="fa fa-check"></i><b>4.5</b> Spatially Aggregated Results</a><ul>
<li class="chapter" data-level="4.5.1" data-path="hydrology.html"><a href="hydrology.html#mean-annual-runoff-1970-1999"><i class="fa fa-check"></i><b>4.5.1</b> Mean Annual Runoff (1970-1999)</a></li>
<li class="chapter" data-level="4.5.2" data-path="hydrology.html"><a href="hydrology.html#flow-duration-index"><i class="fa fa-check"></i><b>4.5.2</b> Flow Duration Index</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="hydrology.html"><a href="hydrology.html#tabulated-results-via-bigquery"><i class="fa fa-check"></i><b>4.6</b> Tabulated Results via BigQuery</a><ul>
<li class="chapter" data-level="4.6.1" data-path="hydrology.html"><a href="hydrology.html#schema"><i class="fa fa-check"></i><b>4.6.1</b> Schema</a></li>
<li class="chapter" data-level="4.6.2" data-path="hydrology.html"><a href="hydrology.html#querying-tabulated-results"><i class="fa fa-check"></i><b>4.6.2</b> Querying Tabulated Results</a></li>
<li class="chapter" data-level="4.6.3" data-path="hydrology.html"><a href="hydrology.html#querying-geometry"><i class="fa fa-check"></i><b>4.6.3</b> Querying Geometry</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="water-quality-statistics.html"><a href="water-quality-statistics.html"><i class="fa fa-check"></i><b>5</b> Water Quality Statistics</a></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stormwater Heatmap Technical Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="land-cover-development" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Land Cover Development</h1>
<p>Our first step was to create a 1-meter resolution land cover layer of the Puget Sound in Google Earth Engine using a Naïve Bayes classifier. We trained the classifier using a subset of a 1-meter resolution land cover dataset (NOAA C-CAP, 2018b) covering Snohomish County, Washington, produced by NOAA C-CAP as a proof-of-concept. Through trial-and-error, we decided upon and composited eleven bands from various sources into a single dataset to be trained. We created the 1-meter Red, Green, Blue and Near-infrared (NIR) reflectance bands by calculating the mean band values from NAIP aerial imagery (U.S. Department of Agriculture, 2019) collected over 2009 to 2019. The eleven composited bands included:</p>
<ul>
<li>Texture: calculated from NAIP NIR band as entropy, or how expected a pixel value is in the context of nearby pixels, in this case using a radius of 12 meters. For more information, see <a href="https://developers.google.com/earth-engine/image_texture">https://developers.google.com/earth-engine/image_texture</a>.</li>
<li>Land use: polygons (Washington State Department of Ecology, 2010) scaled to 1-meter.</li>
<li>Elevation: the USGS National Elevation Dataset (1/3 arc-second) (U.S. Geological Survey, 2015).</li>
<li>Hillshade: produced from the USGS National Elevation Dataset (1/3 arc-second) (U.S. Geological Survey, 2015).</li>
<li>GNDVI: Green Normalized Difference Vegetation Index calculated with NAIP imagery as:</li>
</ul>
<p>(NIR – Green) / (NIR + Green)</p>
<ul>
<li>MSAVI: Modified Soil Adjusted Vegetation Index calculated with NAIP imagery as:</li>
</ul>
<p>½ * (2 * (NIR + 1) - sqrt((2 * NIR + 1)2 – (8 * (NIR – Red))))</p>
<ul>
<li>Binary MSAVI: a Boolean selection of MSAVI where:</li>
</ul>
<p>MSAVI &amp;gt;= 0.5 and MSAVI &amp;lt; 0.9</p>
<ul>
<li>Green: Green NAIP band.</li>
<li>Blue: Blue NAIP band.</li>
<li>Red: Red NAIP band.</li>
<li>NIR: NIR NAIP band.</li>
</ul>
<p>The Naïve Bayes classification result was then smoothed with a dilation process (2-meter focal maximum analysis followed by a 2-m focal minimum analysis). The quality of this product varied among the classes. Vegetated and impervious areas mapped well, but dirt/barren and water were inconsistent and often mistaken for each other or for impervious.</p>
<p>To improve the labels in those inconsistent locations, we used a decision rule and replacement approach using NOAA's 10-meter CCAP land cover dataset (NOAA C-CAP, 2018a), which covers western Washington including the Puget Sound. While this dataset tested high in accuracy already, 10-meters is not an adequate spatial resolution to inform many site-level analyses used in our subsequent stormwater modeling, particularly in highly urbanized areas where vegetation is present but dispersed. However, the CCAP product does well to capture land cover existing at large, continuous extents throughout the landscape, such as forests, vegetated fields, broad sandy beaches, waterbodies, and large parking lots. Recognizing this, we chose to substitute pixels of certain classes from the 1-m classification with the 10-m CCAP. We also used the CCAP water and dirt classes to help clean up shoreline areas using a 10-m focal maximum algorithm to grow the class landward. The decision and replacement approach is as follows for each 1-m pixel, where label ID numbers are listed in Table 1 above:</p>
<pre><code>if: &amp;#39;Rooftop&amp;#39; polygon is in stack, then label 7;

else if: &amp;#39;Dirt Road&amp;#39; polygon is in stack, then label 4;

else if: &amp;#39;Road&amp;#39; polygon or &amp;#39;Over-Water Structure&amp;#39; polygon is in stack, then label 6;

else if: &amp;#39;Inland waterbody&amp;#39; polygon or &amp;#39;County shoreline&amp;#39; polygon is in stack, then label 5;

else if: &amp;#39;1-m Naïve Bayes&amp;#39; label equals &amp;#39;Fine vegetation&amp;#39;, &amp;#39;Medium vegetation&amp;#39;, or &amp;#39;Coarse vegetation&amp;#39;, then respectively label 1, 2, and 3;

else if: &amp;#39;1-m Naïve Bayes&amp;#39; label equals &amp;#39;10-m C-CAP&amp;#39; label, label with that equivalent label;

else if: 10-m radius focal maximum on &amp;#39;10-m C-CAP&amp;#39; label equal to 4 or 5, then respectively label 4 &amp;amp; 5;

else if: &amp;#39;1-m Naïve Bayes&amp;#39; label equals &amp;#39;Dirt/Barren&amp;#39;, then replace with &amp;#39;10-m C-CAP&amp;#39; label;

else: Then label &amp;#39;10-m C-CAP&amp;#39;;</code></pre>
<p>Our final step with the land cover creation was to limit the data to areas below 1,500-meters elevation to exclude permanent ice, e.g. glaciers on Mt. Rainier, which was not classified or necessary for our stormwater model.</p>
<div id="validation-and-accuracy-assessment" class="section level2">
<h2><span class="header-section-number">3.1</span> Validation and Accuracy Assessment</h2>
<p>We validated the predicted land cover dataset in Earth Engine by producing confusion matrices and testing accuracy and kappa statistics. Here, the accuracy test is simply calculated as the number of ground-truthed sample points which correctly match the predicted pixel label divided by the total number of sample points used. We also calculated a kappa statistic, which is generally thought to be a more reliable test as it accounts for chance agreement of the observed and predicted labels. For both tests, zero (0) is lowest accuracy and 1 is highest.</p>
<p>We produced our ground-truth dataset of 34,699 points using a dataset of points and polygons provided by WDFW (Pierce, Jr., 2015). The original points data consisted of 44,882 randomly distributed locations across the Puget Sound which were assigned class names through visual inspection of 2013 NAIP imagery for the purpose of ground-truthing land cover data. The polygons data represent land cover in 2015 and were developed with a segmentation and decision tree approach. We prepared the validation points data with the following process:</p>
<p>Data preparation:</p>
<ol style="list-style-type: decimal">
<li><p>Subset the points by filtering out unlabeled points, points located outside our classification area (e.g. marine water), and points with labels that did not match labels of 2015 land cover polygons. This filtering retained 34,699 of the original 44,882 points.</p></li>
<li><p>Relabel names to six classes:</p></li>
<li><p>‘FinalFineVegetation’ &amp;‘FinalFineVegetationFinalFineVegetation’  ‘Fine Vegetation’</p></li>
<li><p>‘FinalMedium’  ‘Medium Vegetation’</p></li>
<li><p>‘FinalCoarseVegetation’  ‘Coarse Vegetation’</p></li>
<li><p>‘FinalDirt’  ‘Barren/Dirt’</p></li>
<li><p>‘FinalWaterFinalWater’  ‘Water’</p></li>
<li><p>‘BuiltConflict’ &amp; ‘FinalBuilt’ &amp; ‘FinalBuiltBrownRed’  ‘Impervious Developed’</p></li>
<li><p>In Earth Engine, remap the point labels to produce a second set of point features labeled Pervious and Impervious to also validate the dataset for its ability to map impervious surface.</p></li>
<li><p>We randomly selected 3,000 points to use from each of the six classes in the ground-truthed points data to reduce bias towards one or more classes.</p></li>
<li><p>At this point, the two datasets were ready for analysis. We refer to them respectively as: Ground-truthed Land Cover and Ground-truthed Impervious Surface.</p></li>
</ol>
<p>Using those ground-truth points and our seven-class land cover product, we calculated accuracy and kappa statistics for three derivative products of the seven-class land cover dataset: Impervious, Six-class, and Four-class (Table 2).</p>
<ul>
<li>The <strong>Impervious</strong> derivative is a binary dataset where impervious includes rooftops, roads, and other features that force water to run off rather than percolate through the surface. These are labeled referred to as “Built” within the ground-truth points data. We remapped the “Impervious Roofs” and “Impervious Other” to the Impervious class, and all other classes were considered “Non-impervious.”</li>
<li>The <strong>Six-class</strong> derivative includes all classes, but the two impervious classes are remapped to one single Impervious class. These classes are equivalent to the six classes labeled in the ground-truthed points data and the NOAA 10-m Puget Sound land cover dataset.</li>
<li>The <strong>Four-class</strong> derivative includes only the Fine Vegetation, Coarse Vegetation, Water, and Impervious (Built) classes.</li>
</ul>
<p>Table 2. Accuracy and kappa statistics for three derivatives of the seven-class land cover product.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th><em>Impervious</em></th>
<th><em>Six Classes</em></th>
<th><em>Four Classes</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>County</em></td>
<td><em>Accuracy</em></td>
<td><em>Kappa</em></td>
<td><em>Accuracy</em></td>
</tr>
<tr class="even">
<td>Clallam</td>
<td>0.985</td>
<td>0.947</td>
<td>0.702</td>
</tr>
<tr class="odd">
<td>—</td>
<td>—</td>
<td>—</td>
<td>—</td>
</tr>
<tr class="even">
<td>Island</td>
<td>0.987</td>
<td>0.942</td>
<td>0.537</td>
</tr>
<tr class="odd">
<td>Jefferson</td>
<td>0.977</td>
<td>0.931</td>
<td>0.698</td>
</tr>
<tr class="even">
<td>King</td>
<td>0.971</td>
<td>0.898</td>
<td>0.635</td>
</tr>
<tr class="odd">
<td>Kitsap</td>
<td>0.976</td>
<td>0.923</td>
<td>0.725</td>
</tr>
<tr class="even">
<td>Lewis</td>
<td>1.000</td>
<td>1.000</td>
<td>0.612</td>
</tr>
<tr class="odd">
<td>Mason</td>
<td>0.977</td>
<td>0.919</td>
<td>0.686</td>
</tr>
<tr class="even">
<td>Pierce</td>
<td>0.973</td>
<td>0.912</td>
<td>0.626</td>
</tr>
<tr class="odd">
<td>San Juan</td>
<td>0.976</td>
<td>0.899</td>
<td>0.591</td>
</tr>
<tr class="even">
<td>Skagit</td>
<td>0.983</td>
<td>0.926</td>
<td>0.655</td>
</tr>
<tr class="odd">
<td>Snohomish</td>
<td>0.958</td>
<td>0.860</td>
<td>0.646</td>
</tr>
<tr class="even">
<td>Thurston</td>
<td>0.975</td>
<td>0.919</td>
<td>0.641</td>
</tr>
<tr class="odd">
<td>Whatcom</td>
<td>0.987</td>
<td>0.944</td>
<td>0.637</td>
</tr>
</tbody>
</table>
<p>While the Impervious and Four-class derivatives test extremely well with both Accuracy and Kappa statistics, the Six-class derivative tests considerably lower. The Error (Confusion) matrices produced with the Six-class derivative dataset indicate that the Medium Vegetation and Dirt/Barren classes do not match well between our land cover product and the ground-truth points. Inspection of those matrices tells us that the Medium Vegetation ground-truth points were often labeled Fine or Coarse Vegetation in our predicted set. Similarly, the Dirt ground-truth points were often labeled Built or Fine Vegetation.</p>
<p>Some of the discrepancies likely occur because vegetation green-up (particularly in fine vegetation such as grass) can occur differently from year to year and cause mislabeling when comparing data from different periods. Where grass is green in one year's input imagery, it may appear as dirt or barren in another year's imagery if captured during a particularly dry period. These issues may result from error in the land cover labeling, ground-truth labeling, or actual changes in land cover that occurred between the input data dates (i.e. 2013 to 2017). Furthermore, dirt is often mistaken for impervious surfaces (and vice versa) because those surfaces are often built with dirt and stone, thus creating similar spectral reflectance.</p>
<p>Overall, we find the discrepancies to be low concern for the purpose of our stormwater modeling. The horizontal area of the Medium Vegetation and the Dirt/Barren classes in our land cover data is considerably smaller than the other classes, and their respective labeling discrepancies are to classes that are treated similarly to each of them respectively in the stormwater hydrology modeling (e.g. Medium Vegetation is subsequently remapped to Coarse Vegetation).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="high-resolution-land-cover.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hydrology.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["StormwaterHeatmapTechReference.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
