<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Hydrology | Stormwater Heatmap Technical Reference</title>
  <meta name="description" content="Chapter 3 Hydrology | Stormwater Heatmap Technical Reference" />
  <meta name="generator" content="bookdown 0.18.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Hydrology | Stormwater Heatmap Technical Reference" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://stormwaterheatmap.github.io/" />
  
  
  <meta name="github-repo" content="stormwaterheatmap" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Hydrology | Stormwater Heatmap Technical Reference" />
  
  
  

<meta name="author" content="Christian Nilsen, Geosyntec Consultants, Inc." />
<meta name="author" content="Emily Howe, The Nature Conservancy" />
<meta name="author" content="Jaime Robertson, The Nature Conservancy" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="high-resolution-land-cover.html"/>
<link rel="next" href="water-quality-statistics.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.9/datatables.js"></script>
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>



</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-stormwater"><i class="fa fa-check"></i><b>1.1</b> What is stormwater?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#urban-stormwater-runoff-is-a-two-fold-problem-impacting-the-quantity-of-water-pulsing-off-the-land-as-well-as-the-quality-of-that-water."><i class="fa fa-check"></i><b>1.2</b> Urban stormwater runoff is a two-fold problem, impacting the quantity of water pulsing off the land, as well as the quality of that water.</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#water-quantity"><i class="fa fa-check"></i><b>1.2.1</b> Water Quantity</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#water-quality"><i class="fa fa-check"></i><b>1.2.2</b> Water Quality</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#toxic-stormwater-impacts"><i class="fa fa-check"></i><b>1.3</b> Toxic Stormwater Impacts</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#moving-forward--identifying-where-stormwater-pollution-is-generated-on-the-landscape"><i class="fa fa-check"></i><b>1.4</b> Moving forward- identifying where stormwater pollution is generated on the landscape</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#building-an-interactive-tool-to-service-stormwater-manager-needs"><i class="fa fa-check"></i><b>1.5</b> Building an interactive tool to service stormwater manager needs:</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#open-data-helps-us-bound-forward"><i class="fa fa-check"></i><b>1.6</b> Open data helps us bound forward</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="high-resolution-land-cover.html"><a href="high-resolution-land-cover.html"><i class="fa fa-check"></i><b>2</b> High-resolution Land Cover</a><ul>
<li class="chapter" data-level="2.1" data-path="high-resolution-land-cover.html"><a href="high-resolution-land-cover.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="high-resolution-land-cover.html"><a href="high-resolution-land-cover.html#land-cover-development"><i class="fa fa-check"></i><b>2.2</b> Land Cover Development</a></li>
<li class="chapter" data-level="2.3" data-path="high-resolution-land-cover.html"><a href="high-resolution-land-cover.html#validation-and-accuracy-assessment"><i class="fa fa-check"></i><b>2.3</b> Validation and Accuracy Assessment</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hydrology.html"><a href="hydrology.html"><i class="fa fa-check"></i><b>3</b> Hydrology</a><ul>
<li class="chapter" data-level="3.1" data-path="hydrology.html"><a href="hydrology.html#overview-1"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="hydrology.html"><a href="hydrology.html#modeling-approach"><i class="fa fa-check"></i><b>3.2</b> Modeling approach</a><ul>
<li class="chapter" data-level="3.2.1" data-path="hydrology.html"><a href="hydrology.html#hydrologic-response-units"><i class="fa fa-check"></i><b>3.2.1</b> Hydrologic Response Units</a></li>
<li class="chapter" data-level="3.2.2" data-path="hydrology.html"><a href="hydrology.html#regional-calibrated-parameters"><i class="fa fa-check"></i><b>3.2.2</b> Regional Calibrated Parameters</a></li>
<li class="chapter" data-level="3.2.3" data-path="hydrology.html"><a href="hydrology.html#python-implementation"><i class="fa fa-check"></i><b>3.2.3</b> Python Implementation</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="hydrology.html"><a href="hydrology.html#data-sources"><i class="fa fa-check"></i><b>3.3</b> Data Sources</a><ul>
<li class="chapter" data-level="3.3.1" data-path="hydrology.html"><a href="hydrology.html#precipitation"><i class="fa fa-check"></i><b>3.3.1</b> Precipitation</a></li>
<li class="chapter" data-level="3.3.2" data-path="hydrology.html"><a href="hydrology.html#potential-evaporation"><i class="fa fa-check"></i><b>3.3.2</b> Potential Evaporation</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="hydrology.html"><a href="hydrology.html#verficiation-of-results"><i class="fa fa-check"></i><b>3.4</b> Verficiation of Results</a></li>
<li class="chapter" data-level="3.5" data-path="hydrology.html"><a href="hydrology.html#spatially-aggregated-results"><i class="fa fa-check"></i><b>3.5</b> Spatially Aggregated Results</a><ul>
<li class="chapter" data-level="3.5.1" data-path="hydrology.html"><a href="hydrology.html#mean-annual-runoff-1970-1999"><i class="fa fa-check"></i><b>3.5.1</b> Mean Annual Runoff (1970-1999)</a></li>
<li class="chapter" data-level="3.5.2" data-path="hydrology.html"><a href="hydrology.html#flow-duration-index"><i class="fa fa-check"></i><b>3.5.2</b> Flow Duration Index</a></li>
<li class="chapter" data-level="3.5.3" data-path="hydrology.html"><a href="hydrology.html#schema"><i class="fa fa-check"></i><b>3.5.3</b> Schema</a></li>
<li class="chapter" data-level="3.5.4" data-path="hydrology.html"><a href="hydrology.html#querying-tabulated-results"><i class="fa fa-check"></i><b>3.5.4</b> Querying Tabulated Results</a></li>
<li class="chapter" data-level="3.5.5" data-path="hydrology.html"><a href="hydrology.html#querying-geometry"><i class="fa fa-check"></i><b>3.5.5</b> Querying Geometry</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="water-quality-statistics.html"><a href="water-quality-statistics.html"><i class="fa fa-check"></i><b>4</b> Water Quality Statistics</a></li>
<li class="chapter" data-level="5" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>5</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stormwater Heatmap Technical Reference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hydrology" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Hydrology</h1>
<div id="overview-1" class="section level2">
<h2><span class="header-section-number">3.1</span> Overview</h2>
<p>This document provides an overview of hydrology simulation methods and results for the Puget Sound Stormwater heatmap. Continuous hydrology simulation of was performed using regional pre-calibrated parameters. Batched simulations were run for combinations of land cover, soils, and slopes across the Puget Sound domain. Results are stored in a cloud-based database. It is intended to be used in conjunction with data derived from the stormwaterheatmap or other geospatial data sources to quickly model rainfall-runoff relationships across Puget Sound.</p>
</div>
<div id="modeling-approach" class="section level2">
<h2><span class="header-section-number">3.2</span> Modeling approach</h2>
<p>The hydrologic modeling approach was developed to replicate as much as feasible, commonly applied continuous simulation hydrologic analysis for stormwater in Puget Sound. Ecology developed guidance for continuous simulation modeling as described in the Stormwater Manual for Western Washington <span class="citation">(Department of Ecology <a href="#ref-DepartmentofEcology2014" role="doc-biblioref">2014</a>)</span>.</p>
<p>This guidance calls for the application of continuous simulation models based on the Hydrologic Simulation Program Fortran (HSPF). HSPF is a lumped-parameter rainfall-runoff model developed by the USGS and EPA. HSPF is generally used to perform analysis on hydrologic processes related to effects of land cover, interception, surface ponding and soil moisture retention. Although maintenance development of HSPF has not occurred since 1997, it is currently distributed by EPA under the Better Assessment Science Integrating Point and Non-point Sources (BASINS) analysis system. In Western Washington, application of HSPF to stormwater design is routinely performed through the Western Washington Hydrology Model (WWHM), a Windows-based graphical user interface program with built-in meteorologic data and modules specific to stormwater analysis.</p>
<p>HSPF contains a number of specialized modules that are not used by WWHM. These include modules related to snowmelt, sediment budgets, and specific water quality routines. The primary HSPF routines used by WWHM are designated as <code>IWATER</code> (water budget for impervious land cover) and <code>PWATER</code> (water budget for pervious land cover). A graphical schematic of the <code>PWATER</code> routine is shown in Figure <a href="hydrology.html#fig:hspfFig">3.1</a>.</p>
<div class="figure"><span id="fig:hspfFig"></span>
<img src="images/hspf_perlnd.png" alt="HSPF PERLND Conceptual Model" width="264" />
<p class="caption">
Figure 3.1: HSPF PERLND Conceptual Model
</p>
</div>
<div id="hydrologic-response-units" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Hydrologic Response Units</h3>
<p>Modeling was performed on discretized landscape units based on common soils, land cover, and slope charcateristics known as hydrologic response units (HRUs). The HRU approach provides a computationally efficient method of pre-computing hydrolgic response for later use. Results for a particular watershed can be calculated by on summing or averaging the results for individual HRUs.</p>
<p>Each combination of parameters were modeled in separate batched simulations. HRUs were designated by a three-digit number according to the following convention:</p>
<ul>
<li>First digit: Hydrologic Soil Group Number (0 = A/B, 1 = C, 2 = Saturated)</li>
<li>Second digit: Land cover (0=Forest, 1=Pasture, 2=Lawn, 5=Impervious),</li>
<li>Third Digit: Slope (0=Flat, 1=Mod, 2=Steep)</li>
</ul>
<p>For example, a site with Type C soils, with forested land cover, on a moderate slope would be represented by <code>101</code>. This schema allowed for HRUs to be stored as an eight-bit unsigned integer on a Puget-Sound wide raster, minimizing storage size.</p>
</div>
<div id="regional-calibrated-parameters" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Regional Calibrated Parameters</h3>
<p>Regional calibration factors for the Puget Lowlands Ecoregion were developed the USGS in the 1990s <span class="citation">(Dinicola <a href="#ref-Dinicola1990" role="doc-biblioref">1990</a>)</span> and updated by Clear Creek Solutions for use within WWHM <span class="citation">(Department of Ecology <a href="#ref-DepartmentofEcology2014" role="doc-biblioref">2014</a>)</span>. These parameters, referred to as the ‘default parameters’ by Ecology were used in this study and applied to individual HRUs.</p>
<div id="htmlwidget-fa0e4bf201937ff79dc5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fa0e4bf201937ff79dc5">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],["A/B","A/B","A/B","A/B","A/B","A/B","A/B","A/B","A/B","C","C","C","C","C","C","C","C","C","SAT","SAT","SAT","SAT","SAT","SAT","SAT","SAT","SAT","Impervious","Impervious","Impervious"],["Forest","Forest","Forest","Pasture","Pasture","Pasture","Lawn","Lawn","Lawn","Forest","Forest","Forest","Pasture","Pasture","Pasture","Lawn","Lawn","Lawn","Forest","Forest","Forest","Pasture","Pasture","Pasture","Lawn","Lawn","Lawn","Impervious","Impervious","Impervious"],["Flat","Mod","Steep","Flat","Mod","Steep","Flat","Mod","Steep","Flat","Mod","Steep","Flat","Mod","Steep","Flat","Mod","Steep","Flat","Mod","Steep","Flat","Mod","Steep","Flat","Mod","Steep","Flat","Moderate","Steep"],[5,5,5,5,5,5,5,5,5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4.5,4,4,4,4,4,4,4,4,4,null,null,null],[2,2,2,1.5,1.5,1.5,0.8,0.8,0.8,0.08,0.08,0.08,0.06,0.06,0.06,0.03,0.03,0.03,2,2,2,1.8,1.8,1.8,1,1,1,null,null,null],[400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,100,100,100,100,100,100,100,100,100,400,400,400],[0.05,0.1,0.15,0.05,0.1,0.15,0.05,0.1,0.15,0.05,0.1,0.15,0.05,0.1,0.15,0.05,0.1,0.15,0.001,0.01,0.1,0.001,0.01,0.1,0.001,0.01,0.1,0.01,0.05,0.1],[0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.3,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,null,null,null],[0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,0.996,null,null,null],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,10,10,10,10,10,10,10,10,10,null,null,null],[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,null,null,null],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,null,null,null],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.7,0.7,0.7,0.5,0.5,0.5,0.35,0.35,0.35,null,null,null],[0.2,0.2,0.2,0.15,0.15,0.15,0.1,0.1,0.1,0.2,0.2,0.2,0.15,0.15,0.15,0.1,0.1,0.1,0.2,0.2,0.2,0.15,0.15,0.15,0.1,0.1,0.1,null,null,null],[0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.3,0.4,0.4,0.25,0.25,0.25,0.15,3,3,3,3,3,3,3,3,3,null,null,null],[0.35,0.35,0.35,0.3,0.3,0.3,0.25,0.25,0.25,0.35,0.35,0.35,0.3,0.3,0.3,0.25,0.25,0.25,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.1,0.1,0.1],[0,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,6,1,1,1,1,1,1,1,1,1,null,null,null],[0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.5,0.5,0.3,0.5,0.5,0.3,0.5,0.5,0.3,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,null,null,null],[0.7,0.7,0.7,0.4,0.4,0.4,0.25,0.25,0.25,0.7,0.7,0.7,0.4,0.4,0.4,0.25,0.25,0.25,0.8,0.8,0.8,0.6,0.6,0.6,0.4,0.4,0.4,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1,1,1],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.1,0.08,0.05]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Soil<\/th>\n      <th>Land Cover<\/th>\n      <th>Slope<\/th>\n      <th>LZSN<\/th>\n      <th>INFILT<\/th>\n      <th>LSUR<\/th>\n      <th>SLSUR<\/th>\n      <th>KVARY<\/th>\n      <th>AGWRC<\/th>\n      <th>INFEXP<\/th>\n      <th>INFILD<\/th>\n      <th>BASETP<\/th>\n      <th>AGWETP<\/th>\n      <th>CEPSC<\/th>\n      <th>UZSN<\/th>\n      <th>NSUR<\/th>\n      <th>INTFW<\/th>\n      <th>IRC<\/th>\n      <th>LZETP<\/th>\n      <th>IWAT<\/th>\n      <th>RETSC<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="python-implementation" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Python Implementation</h3>
<p>To allow for parallel computations, we used a Python adaption of HSPF developed by David Lambert with funding from the United States Department of Energy, Energy Efficiency &amp; Renewable Energy, Bioenergy Technologies Office <span class="citation">(Lampert <a href="#ref-Lampert2019" role="doc-biblioref">2019</a>)</span>. PyHSPF is able to generated HSPF input files, run simulations, and provide HSPF compatible output. Similar to WWHM, we provided separate output files for three flow-paths. Surface flow, interflow, and groundwater flow. In HSPF, these output classes are referred to as <code>SURO</code>, <code>INFW</code>, and <code>AGWO</code> respectively. We developed and ran individual HSPY models for each combination of HRU and Precipitation grid and generated output for each flow patch component. This resulted in 27,990 individual output files.</p>
</div>
</div>
<div id="data-sources" class="section level2">
<h2><span class="header-section-number">3.3</span> Data Sources</h2>
<div id="precipitation" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Precipitation</h3>
<p>A region-wide, simulated precipitation dataset was provided by the University of Washington Climate Impacts Group. Methodology used to develop this dataset is documented in <span class="citation">(Mauger et al. <a href="#ref-Jr2018" role="doc-biblioref">2018</a>)</span>.The dataset contains modeled hourly precipitation using the GFDL CM3 global climate model and the Representative Concentration Pathways (RCP) 8.5 scenario.</p>
<p>GCM selection based on stormwater applications. Emphasized winter storm drivers.
Downscaled from GFDL CM3. RCP 8.5 (High emissions) “High-High”
Hourly precipitation developed through application of regional weather model, the Weather Research and Forecasting (WRF, Skamarock et al. 2005).</p>
<p>The GFDL model was chosen by CIG to due to its ability to accurately model winter storm drivers, important for stormwater applications. Combined with the higher emissions scenario, this modeling scenario represents the upper end of expected future climate changes effects.</p>
<p>CIG downscaled GCM results using a statistical-dynamical approach to capture the anticipated changes in extreme events as well as the different drivers of rainfall that affect the Puget Sound Region. Regional simulations were performed using the Weather Research and Forecasting community mesoscale model. This resulted in hourly rainfall predictions at an approximately 12 km grid size across Puget Sound. Predictions were bias-corrected on a quantile-mapping basis (individual mean bias corrections for precipitation in each quantile range) using the historic (1970-2005) WRF data. The WRF Grid in our study area is shown in Figure <a href="hydrology.html#fig:wrfGrid">3.2</a>.</p>
<div class="figure"><span id="fig:wrfGrid"></span>
<img src="qgis/for_figure.png" alt="WRF Forecasting Grid" width="622" />
<p class="caption">
Figure 3.2: WRF Forecasting Grid
</p>
</div>
</div>
<div id="potential-evaporation" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Potential Evaporation</h3>
<p>Gridded potential evaporation estimates were acquired from the forcing data for the North American Land Data Assimilation System (NLDAS2) <span class="citation">(NASA Goddard Earth Sciences Data and Information Services Center (GES DISC) <a href="#ref-NASAGoddardEarthSciencesDataandInformationServicesCenterGESDISC2019" role="doc-biblioref">2019</a>)</span>. This dataset combines multiple sources of observations to produce estimates of surface climate variables. Evaporation data was derived from the NCEP North American Regional Reanalysis, consisting of a retrospective dataset beginning January 1979 through December 2005. Data were acquired in in 1/8th-degree grid spacing; at an hourly temporal resolution. Average monthly potential evaporation rates were calculated and resampled for each grid cell in the heatmap model domain.</p>
<div id="land-cover" class="section level4">
<h4><span class="header-section-number">3.3.2.1</span> Land Cover</h4>
<p>Land cover was derived from the Nature Conservancy’s high-resolution land cover data set. See Section xx for more informaiton.</p>
</div>
<div id="soils" class="section level4">
<h4><span class="header-section-number">3.3.2.2</span> Soils</h4>
<div id="gridded-ssurgo-data" class="section level5">
<h5><span class="header-section-number">3.3.2.2.1</span> Gridded SSURGO Data</h5>
<p>The primary source of soils data was the Gridded Soil Survey Geographic Database (gSSURGO), <span class="citation">(Soil Survey Staff <a href="#ref-SoilSurveyStaff2018" role="doc-biblioref">2018</a>)</span>. The gridded soils database contains 10-meter rasterized coverage of surface soils derived from National Cooperate Soil Survey (NCSS) maps. These maps are generally drawn at 1:24000 scale. NCSS designates soils by a “map-unit name,” which can be joined with other attribute data. Map units in the study area were joined with the soils component table, containing hydrologic-soil group designations. NCSS classifies hydrologic soil groups according to estimates of runoff potential. Soils are assigned to four groups (A, B, C, and D) and three dual classes (A/D, B/D, and C/D) as defined below:</p>
<ul>
<li><p><strong>Group A.</strong> Soils having a high infiltration rate (low runoff potential) when thoroughly wet.
These consist mainly of deep, well drained to excessively drained sands or gravelly sands.
These soils have a high rate of water transmission.</p></li>
<li><p><strong>Group B.</strong> Soils having a moderate infiltration rate when thoroughly wet. These consist
chiefly of moderately deep or deep, moderately well drained or well drained soils that have
moderately fine texture to moderately coarse texture. These soils have a moderate rate of
water transmission.</p></li>
<li><p><strong>Group C.</strong> Soils having a slow infiltration rate when thoroughly wet. These consist chiefly of
soils having a layer that impedes the downward movement of water or soils of moderately
fine texture or fine texture. These soils have a slow rate of water transmission.</p></li>
<li><p><strong>Group D.</strong> Soils having a very slow infiltration rate (high runoff potential) when thoroughly
wet. These consist chiefly of clays that have a high shrink-swell potential, soils that have a
high water table, soils that have a claypan or clay layer at or near the surface, and soils that
are shallow over nearly impervious material. These soils have a very slow rate of water
transmission.</p></li>
</ul>
<p>If a soil is assigned to a dual hydrologic group (A/D, B/D, or C/D), the first letter is for
drained areas and the second is for undrained areas. Only the soils that in their natural
condition are in group D are assigned to dual classes. In certain locations, data were augmented with the SSURGO Value added tables <span class="citation">(Soil Survey Staff <a href="#ref-SoilSurveyStaff2016" role="doc-biblioref">2016</a>)</span> using the Potential wetland soil landscapes field.</p>
</div>
<div id="oak-ridge-national-laboratory-hysogs250m" class="section level5">
<h5><span class="header-section-number">3.3.2.2.2</span> Oak Ridge National Laboratory HYSOGs250m</h5>
<p>In areas where gSSURGO data were not available, we used the Global Hydrologic Soil Groups (HYSOGs250m) for Curve Number-Based Runoff Modeling developed by Oak Ridge National Laboratory [RossC.W.L.PrihodkoJ.Y.AnchangS.S.KumarW.Ji2018]. This dataset contains world-wide hydrologic soils groups derived at a 250 meter resolution from machine learning predictions. Hydrologic soil groups were given the same designation as the SSURGO data above.</p>
</div>
<div id="gaplandfire-data" class="section level5">
<h5><span class="header-section-number">3.3.2.2.3</span> GAP/LANDFIRE DATA</h5>
<p>To account for wetlands and saturated soils not included in the above datasets, we used the USGS GAP/LANDFIRE National Terrestrial Ecosystems data set, which includes nationwide vegetation and land cover data.</p>
</div>
</div>
<div id="slope" class="section level4">
<h4><span class="header-section-number">3.3.2.3</span> Slope</h4>
<p>Slope values were calculated from the USGS National Elevation Dataset. Elevations were provided in 1/3 arc-second resolution (approximately 10-meters). Slope was calculated and classified into the following categories, consistent with Ecology guidance:<br />
- Flat: &lt; 5%<br />
- Moderate: 5-15%<br />
- Steep: &gt; 15%</p>
</div>
</div>
</div>
<div id="verficiation-of-results" class="section level2">
<h2><span class="header-section-number">3.4</span> Verficiation of Results</h2>
<p>Verification of modeling results was first performed by evaluating the annual runoff amounts over the historic period of record as a percentage of annual precipitation. Figures <a href="hydrology.html#fig:figQplots1">3.3</a> through <a href="hydrology.html#fig:figQplots4">3.6</a> annual runoff results for the Seattle-Tacoma International Airport.</p>
<div class="figure"><span id="fig:figQplots1"></span>
<img src="StormwaterHeatmapTechReference_files/figure-html/figQplots1-1.png" alt="Annual Runoff as a percentage of precipitation for outwash soils" width="672" />
<p class="caption">
Figure 3.3: Annual Runoff as a percentage of precipitation for outwash soils
</p>
</div>
<div class="figure"><span id="fig:figQplots2"></span>
<img src="StormwaterHeatmapTechReference_files/figure-html/figQplots2-1.png" alt="Annual Runoff as a percentage of precipitation for till soils" width="672" />
<p class="caption">
Figure 3.4: Annual Runoff as a percentage of precipitation for till soils
</p>
</div>
<div class="figure"><span id="fig:figQplots3"></span>
<img src="StormwaterHeatmapTechReference_files/figure-html/figQplots3-1.png" alt="Annual Runoff as a percentage of precipitation for saturated soils" width="672" />
<p class="caption">
Figure 3.5: Annual Runoff as a percentage of precipitation for saturated soils
</p>
</div>
<div class="figure"><span id="fig:figQplots4"></span>
<img src="StormwaterHeatmapTechReference_files/figure-html/figQplots4-1.png" alt="Annual Runoff as a percentage of precipitation for impervious land cover" width="672" />
<p class="caption">
Figure 3.6: Annual Runoff as a percentage of precipitation for impervious land cover
</p>
</div>
<p>Next, results were verified by comparing modeling results to measured stream flow for a gaged watershed in King County. King County operates a stream gage on Madsen Creek, near Renton. The watershed above the gage site is approximately 2,000 acres, with about 25% imperviousness.</p>
<p>Daily streamflow data for the Madsen Creek watershed was provided by King County for the period 1991-2010. We delineated the watershed above the gaging site using the USGS NHDPLus flow-conditioned raster <span class="citation">(<span class="citeproc-not-found" data-reference-id="moore2019user"><strong>???</strong></span>)</span>.
Using this watershed boundary, we extracted HRUs and associated areas from the stormwater heatmap HRU layer on Google Earth Engine. HRU results and areas are shown in Table <a href="#tab:madsenTable"><strong>??</strong></a>.</p>
<div id="htmlwidget-ffbd81f17841c251a439" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ffbd81f17841c251a439">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27"],["hru000","hru001","hru002","hru010","hru011","hru012","hru020","hru021","hru022","hru100","hru101","hru102","hru110","hru111","hru112","hru120","hru121","hru122","hru200","hru201","hru210","hru211","hru220","hru221","hru250","hru251","hru252"],[2432168,1228910,743614,556435.1,153862,24682.16,909390.8,230017,17757.89,93139.05,9888.5,6064.56,13569.95,2032.37,230.02,118094.3,7885.95,243.56,90542.94,3724.2,22074.19,1212.49,42232.11,2335.62,1477833,320216.8,25874.91],[601.001891,303.670347,183.751019,137.498118,38.020137,6.099095,224.715351,56.838437,4.38807,23.01516,2.443502,1.498585,3.353207,0.502208,0.05684,29.181745,1.948661,0.060185,22.373647,0.920269,5.454652,0.299612,10.435781,0.577145,365.180393,79.127303,6.393828],["A/B","A/B","A/B","A/B","A/B","A/B","A/B","A/B","A/B","C","C","C","C","C","C","C","C","C","D","D","D","D","D","D","D","D","D"],["forest","forest","forest","pasture","pasture","pasture","lawn","lawn","lawn","forest","forest","forest","pasture","pasture","pasture","lawn","lawn","lawn","forest","forest","pasture","pasture","lawn","lawn","impervious","impervious","impervious"],["flat","moderate","steep","flat","moderate","steep","flat","moderate","steep","flat","moderate","steep","flat","moderate","steep","flat","moderate","steep","flat","moderate","flat","moderate","flat","moderate","flat","moderate","steep"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>hruName<\/th>\n      <th>sq.m<\/th>\n      <th>acres<\/th>\n      <th>soil<\/th>\n      <th>land cover<\/th>\n      <th>slope<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Modeling results were then queried and aggregated from the BigQuery dataset as described in [Tabulated Results via BigQuery]. The same HRU values were also run in WWHM for comparison. Both the WWHM and BigQuery results were truncated to have the same period of record as the streamflow data. Only the surface runoff and interflow components were used in this analysis.</p>
<p>Figure @madsenFig shows a comparison of the observed and simulation flow-durations for the Madsen Creek watershed.</p>
<div class="figure"><span id="fig:madsenFig"></span>
<img src="StormwaterHeatmapTechReference_files/figure-html/madsenFig-1.png" alt="Observed and simulated flow-duration curves for Madsen Creek, King County, WA" width="672" />
<p class="caption">
Figure 3.7: Observed and simulated flow-duration curves for Madsen Creek, King County, WA
</p>
</div>
<p>Both the WWHM and HSPY results underpredict actual streamflow primarly because baseflow was not simulated. This is expected, since both models exclude groundwater contributions. However, the results show good agreement between both simulated datasets over the full duration of simulations. Note that the simulations use different precipitation and potential evaporation datasets and are not expected to match.</p>
</div>
<div id="spatially-aggregated-results" class="section level2">
<h2><span class="header-section-number">3.5</span> Spatially Aggregated Results</h2>
<p>Since the HSPY model is a lumped parameter model, results can be calculated for HRU/precipitation grids individually and then aggregated after calculation.</p>
<p>The stormwater heatmap contains two spatial aggregates of hydrology results: Mean Annual Runoff for the historic period (1970-1999) and a new index, termed the Flow Duration Index.</p>
<div id="mean-annual-runoff-1970-1999" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Mean Annual Runoff (1970-1999)</h3>
<p>Mean annual runoff for each HRU/grid combination was aggregated from BigQuery for the historic period of record (1970-1999). Consistent with Ecology guidance for stormwater projects, only the surface flow components, <code>SURO</code> and <code>IFWO</code> were used. <code>AGWO</code>, deep groundwater flow, was not included in this calculation.</p>
<p>Total runoff was calculated for each year/hru/grid combination in the period of record, then averaged by hru/grid combination.</p>
<!-- Citations
Figures \@ref(fig:outwash_fig2) through xx show box plots of mean annual runoff results for the historic period of record for each modeled soil type.
<!\@ref(fig:wrfGrid).-->
<p><img src="StormwaterHeatmapTechReference_files/figure-html/unnamed-chunk-3-1.png" width="768" /></p>
</div>
<div id="flow-duration-index" class="section level3">
<h3><span class="header-section-number">3.5.2</span> Flow Duration Index</h3>
<div id="ecology-performance-standards" class="section level4">
<h4><span class="header-section-number">3.5.2.1</span> Ecology Performance Standards</h4>
<p>Ecology Stormwater Guidance includes flow-related performance standards to protect receiving waters from degradation caused by changes in the hydrologic regime due to development. These performance standards rely on flow-duration matching, whereby flow durations from developed land are required to match pre-developed flow-durations for a range of discharge values.The flow duration standard is intended to prevent flashy flows in receiving stream channels.</p>
</div>
<div id="calculation-of-the-index" class="section level4">
<h4><span class="header-section-number">3.5.2.2</span> Calculation of the Index</h4>
<p>We developed an index representing the magnitude of change to the flow-duration curve between flow thresholds.Thresholds were chosen based on Ecology’s LID and Flow Control Standards <span class="citation">(Department of Ecology <a href="#ref-DepartmentofEcology2014" role="doc-biblioref">2014</a>)</span>, which require flow-duration matching over the range between 8 percent of the 2-year peak discharge (lower threshold of the LID standard) up to the 50-year peak discharge (upper threshold of the flow-control standard).</p>
<p>The flow discharge index is calculated by summing the discharge over the simulation period between a high-flow and low-flow threshold. Figure <a href="hydrology.html#fig:fdrfig">3.8</a> illustrates the summation of flow-duration values used in calculating this index.</p>
<div class="figure"><span id="fig:fdrfig"></span>
<img src="StormwaterHeatmapTechReference_files/figure-html/fdrfig-1.png" alt="Example flow duration curves of altered and forested land covers" width="672" />
<p class="caption">
Figure 3.8: Example flow duration curves of altered and forested land covers
</p>
</div>
<p>The flow duration index can be described by Equation <a href="#eq:fdr">(<strong>??</strong>)</a>.</p>
<p><span class="math display">\[\begin{equation}
  \ln\left(\frac{\sum_{ }^{ }q_{current}\Delta t}{\sum_{ }^{ }q_{forest}\Delta t}+1\right)
  (\#eq:fdr)
\end{equation}\]</span>0.08Q_2&lt;q  Q_{50};0.08Q_2&lt;q  Q_{50}</p>
<p>Where q<sub>current</sub> is the simulated discharge for current or altered conditions and q<sub>forest</sub> is the predevelopment or forested conditions. One is added to this ratio and the logarithm is taken to produce an index that generally falls between 1 and 10. This index is then applied to hru/grid combinations in the stormwater heatmap to produce a spatially explicit mapping of flow alteration.</p>
</div>
<div id="flow-duration-summary-index" class="section level4">
<h4><span class="header-section-number">3.5.2.3</span> Flow Duration Summary Index</h4>
<p><img src="StormwaterHeatmapTechReference_files/figure-html/unnamed-chunk-4-1.png" width="672" />
## Tabulated Results via BigQuery</p>
<p>Tabulated hydrology results are available via <a href="https://cloud.google.com/bigquery">Google BigQuery</a>, a cloud-based relational database that includes a distributed SQL engine. The data are located on the <a href="https://console.cloud.google.com/bigquery?project=tnc-data-v1"><code>tnc-data-v1</code> data bucket</a> (sign-in require). The table is named <code>tnc-data-v1:hydrology.gfdl.</code> BigQuery supports several client libraries. See <a href="https://cloud.google.com/bigquery/docs/reference/libraries" class="uri">https://cloud.google.com/bigquery/docs/reference/libraries</a> for a list of supported clients libraries.</p>
<p>Using R, the tnc-data-v1 databucket can be accessed through a database connection using the DBI package:</p>
</div>
</div>
<div id="schema" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Schema</h3>
<p>The table schema are shown in Table <a href="hydrology.html#tab:schemaTable">3.1</a>.</p>
<table>
<caption>
<span id="tab:schemaTable">Table 3.1: </span>BigQuery Table Schema for <code>tnc-data-v1:hydrology.gfdl.</code>
</caption>
<thead>
<tr>
<th style="text-align:left;">
Fieldname
</th>
<th style="text-align:left;">
Type
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
grid
</td>
<td style="text-align:left;">
STRING
</td>
<td style="text-align:left;">
WRF Grid ID Number
</td>
</tr>
<tr>
<td style="text-align:left;">
year
</td>
<td style="text-align:left;">
INTEGER
</td>
<td style="text-align:left;">
Year of Simulation
</td>
</tr>
<tr>
<td style="text-align:left;">
month
</td>
<td style="text-align:left;">
INTEGER
</td>
<td style="text-align:left;">
Month of Simulation
</td>
</tr>
<tr>
<td style="text-align:left;">
comp
</td>
<td style="text-align:left;">
STRING
</td>
<td style="text-align:left;">
HSPF Runoff component (AGWO, IFWO, SURO)
</td>
</tr>
<tr>
<td style="text-align:left;">
hru000 … hru252
</td>
<td style="text-align:left;">
STRING
</td>
<td style="text-align:left;">
Runoff (mm) (one column for each HRU)
</td>
</tr>
<tr>
<td style="text-align:left;">
Datetime
</td>
<td style="text-align:left;">
TIMESTAMP
</td>
<td style="text-align:left;">
Simulation Hour (UTC)
</td>
</tr>
<tr>
<td style="text-align:left;">
simulation_day
</td>
<td style="text-align:left;">
INTEGER
</td>
<td style="text-align:left;">
Day of simulation (01-Jan-1970 = Day 1)
</td>
</tr>
<tr>
<td style="text-align:left;">
simulation_day
</td>
<td style="text-align:left;">
INTEGER
</td>
<td style="text-align:left;">
Day of simulation (01-Jan-1970 = Day 1)|
</td>
</tr>
</tbody>
</table>
</div>
<div id="querying-tabulated-results" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Querying Tabulated Results</h3>
<p>The data may be queried through Google Cloud Platform directly, or through a number of available software libraries. Queries are performed through standard SQL language. Some example queries are provided below.</p>
<p>Get all surface flow components from the SeaTac precipitation grid (ID16_V7) for the years 1970-1999:</p>
<p>Get the annual peak flow for surface flow components from the SeaTac precipitation grid (ID16_V7) for the years 1970-1999:</p>
</div>
<div id="querying-geometry" class="section level3">
<h3><span class="header-section-number">3.5.5</span> Querying Geometry</h3>
<p>Google BigQuery supports PostGIS geometry functions (see <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/geography_functions" class="uri">https://cloud.google.com/bigquery/docs/reference/standard-sql/geography_functions</a> for instructions).</p>
<p>Grid geometries are available from the <code>tnc-data-v1.gfdl.geometry</code> table on Big Query. The table schema is as follows:</p>
<table>
<thead>
<tr class="header">
<th>Fieldname</th>
<th>Type</th>
<th>Description</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>grid</td>
<td>STRING</td>
<td>WRF Grid ID Number</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>xy</td>
<td>GEOGRAPHY</td>
<td>Centroid of the grid (PostGIS point) )</td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>geohash</td>
<td>String</td>
<td>PostGIS geohash string approximating grid boundary</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>geometry</td>
<td>STRING</td>
<td>Well known text format of the grid boundary</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>An example query to return the Grid ID covering the Seattle Center:</p>
<p>Returns the grid ID pertaining to this location:</p>
<pre><code>Row  grid
-----------
 1  ID16_V9</code></pre>
<!-- Citations

end chapter
--->

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-DepartmentofEcology2014">
<p>Department of Ecology. 2014. “Stormwater Management Manual for Western Washington,” 1192.</p>
</div>
<div id="ref-Dinicola1990">
<p>Dinicola, Richard S. 1990. “Characterization and simulation of rainfall-runoff relations for headwater basins in western King and Snohomish Counties, Washington.” <em>Water-Resources Investigations Report</em> 89-4052: 52 p. <a href="https://pubs.er.usgs.gov/publication/wri894052">https://pubs.er.usgs.gov/publication/wri894052</a>.</p>
</div>
<div id="ref-Lampert2019">
<p>Lampert, David. 2019. “PyHSPF.” <a href="https://github.com/djlampert/PyHSPF">https://github.com/djlampert/PyHSPF</a>.</p>
</div>
<div id="ref-Jr2018">
<p>Mauger, G. S., J. S. Won, K. Hegewisch, C. Lynch, R. Lorente Plazas, Salathe, and E. P. Salathé Jr. 2018. “New Projections of Changing Heavy Precipitation in King County.”</p>
</div>
<div id="ref-NASAGoddardEarthSciencesDataandInformationServicesCenterGESDISC2019">
<p>NASA Goddard Earth Sciences Data and Information Services Center (GES DISC). 2019. “NLDAS-2: North American Land Data Assimilation System Forcing Fields.”</p>
</div>
<div id="ref-SoilSurveyStaff2016">
<p>Soil Survey Staff. 2016. “National Value Added Look Up (valu) Table Database for the Gridded Soil Survey Geographic (gSSURGO) Database for the United States of America and the Territories, Commonwealths, and Island Nations served by the USDA-NRCS.”</p>
</div>
<div id="ref-SoilSurveyStaff2018">
<p>Soil Survey Staff. 2018. “Gridded Soil Survey Geographic (gSSURGO) Database for Washington.” <a href="https://gdg.sc.egov.usda.gov/">https://gdg.sc.egov.usda.gov/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="high-resolution-land-cover.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="water-quality-statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["StormwaterHeatmapTechReference.pdf"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
